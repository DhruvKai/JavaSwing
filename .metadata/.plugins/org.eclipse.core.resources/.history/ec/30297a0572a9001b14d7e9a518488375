package dmbs;


import java.sql.*;
import java.io.*;

public class program {
	public static void main(String[] args) {
		String jdbcURL = "jdbc:postgresql://localhost:5432/email";
		String username = "postgres";
        String password = "dhruvkaith";
       
       try {
    	   Connection connection =  DriverManager.getConnection(jdbcURL, username, password);
    	   System.out.println("Connected ");
    	   
    	   String sql = "INSERT INTO record(name, attachment) VALUES (?,?)";
    	   
    	   //Statement statement = connection.createStatement();
    	   PreparedStatement pstmt = connection.prepareStatement(sql);
    	   
    	   pstmt.setString(1, "Dhruv");
    	   FileInputStream fis = new FileInputStream("A:\\sample.png");
    	   pstmt.setBinaryStream(2, fis,fis.available());
    	   pstmt.executeUpdate();
    	 /*  int rows = statement.executeUpdate(sql);
    	   if (rows > 0) {
    		   System.out.print("A new entry is entered");
    	   }*/
    	   connection.close();

       } catch(SQLException | IOException e) {
    	   System.out.println("Error in connecting to databse");
    	   e.printStackTrace();
       }
	}
}
